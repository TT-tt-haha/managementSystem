{"remainingRequest":"E:\\code\\javacode\\elementUI\\euiadmin\\node_modules\\babel-loader\\lib\\index.js!E:\\code\\javacode\\elementUI\\euiadmin\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\code\\javacode\\elementUI\\euiadmin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\code\\javacode\\elementUI\\euiadmin\\src\\components\\module\\excel\\ImportExcel.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\code\\javacode\\elementUI\\euiadmin\\src\\components\\module\\excel\\ImportExcel.vue","mtime":1610691726691},{"path":"E:\\code\\javacode\\elementUI\\euiadmin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\code\\javacode\\elementUI\\euiadmin\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"E:\\code\\javacode\\elementUI\\euiadmin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\code\\javacode\\elementUI\\euiadmin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZm9yLWVhY2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3Qua2V5cy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2guanMiOwppbXBvcnQgX3RvQ29uc3VtYWJsZUFycmF5IGZyb20gIkU6L2NvZGUvamF2YWNvZGUvZWxlbWVudFVJL2V1aWFkbWluL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS90b0NvbnN1bWFibGVBcnJheSI7Ci8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCmltcG9ydCBYTFNYIGZyb20gInhsc3giOwpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGZpbGU6ICIiLAogICAgICBleGNlbF9pbXBvcnRfZGF0YTogJycKICAgIH07CiAgfSwKICBtZXRob2RzOiB7CiAgICBjaG9vc2VfZmlsZTogZnVuY3Rpb24gY2hvb3NlX2ZpbGUoZmlsZSkgewogICAgICB0aGlzLmZpbGUgPSBmaWxlLnJhdzsgLy8gICBjb25zb2xlLmxvZyh0aGlzLmZpbGUpOwoKICAgICAgdGhpcy5pbXBvcnRFeGNlbCh0aGlzLmZpbGUpOwogICAgfSwKICAgIGltcG9ydEV4Y2VsOiBmdW5jdGlvbiBpbXBvcnRFeGNlbChmaWxlKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICB2YXIgZXhjZWxEYXRhID0gW107IC8v5aOw5piO5LiA5Liq5paH5Lu26K+75Y+W5ZmoCgogICAgICB2YXIgZmlsZVJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7IC8v5paH5Lu26K+75Y+W5oiQ5Yqf5pe26Kem5Y+R5LqL5Lu2CgogICAgICBmaWxlUmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uIChldikgewogICAgICAgIHRyeSB7CiAgICAgICAgICAvL+ivu+WPlueahOaWh+S7tjsKICAgICAgICAgIHZhciBkYXRhID0gZXYudGFyZ2V0LnJlc3VsdDsgLy/ku6Xkuozov5vliLbmtYHmlrnlvI/or7vlj5blvpfliLDmlbTku71leGNlbOihqOagvAoKICAgICAgICAgIHZhciB3b3JrYm9vayA9IFhMU1gucmVhZChkYXRhLCB7CiAgICAgICAgICAgIHR5cGU6ICJiaW5hcnkiCiAgICAgICAgICB9KTsgLy8g5b6q546v6YGN5Y6GZXhjZWznmoRzaGVldOWvueixoQoKICAgICAgICAgIE9iamVjdC5rZXlzKHdvcmtib29rLlNoZWV0cykuZm9yRWFjaChmdW5jdGlvbiAoc2hlZXQpIHsKICAgICAgICAgICAgY29uc29sZS5pbmZvKHdvcmtib29rLlNoZWV0c1tzaGVldF1bIiFyZWYiXSk7CiAgICAgICAgICAgIGV4Y2VsRGF0YS5wdXNoLmFwcGx5KGV4Y2VsRGF0YSwgX3RvQ29uc3VtYWJsZUFycmF5KFhMU1gudXRpbHMuc2hlZXRfdG9fanNvbih3b3JrYm9vay5TaGVldHNbc2hlZXRdKSkpOwogICAgICAgICAgfSk7IC8vIOiHquWumuS5ieS6i+S7tu+8jOavlOWmguagoemqjGV4Y2Vs5pWw5o2u44CC6L2s5o2i5pWw5o2u5qC85byP4oCmCiAgICAgICAgICAvLyBjb25zb2xlLmxvZyhleGNlbERhdGEpLy/mnKrovazmjaJrZXnlgLznmoTmlbDmja4KCiAgICAgICAgICBfdGhpcy5jaGFuZ2VLZXkoZXhjZWxEYXRhKTsgLy/osIPnlKjovazmjaJrZXnlgLwKCiAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgX3RoaXMuJG1lc3NhZ2UuZGFuZ2VyKCfmlofku7bnsbvlnovkuI3mraPnoa4nKTsKICAgICAgICB9CiAgICAgIH07IC8v6K+75Y+W5paH5Lu2CgoKICAgICAgZmlsZVJlYWRlci5yZWFkQXNCaW5hcnlTdHJpbmcoZmlsZSk7CiAgICB9LAogICAgY2hhbmdlS2V5OiBmdW5jdGlvbiBjaGFuZ2VLZXkoZXhjZWxEYXRhKSB7CiAgICAgIHZhciBuZXdLZXlNYXAgPSB7CiAgICAgICAgLy9rZXnovazmjaLlrZflhbjvvIzlt6bkvqfkuLrml6fnmoRrZXnlgLzjgILlj7PkvqfkuLrmlrBrZXnlgLwKICAgICAgICAn5pi156ewJzogJ3VzZXJfcGV0X25hbWUnLAogICAgICAgICfnlKjmiLflkI0nOiAndXNlcl9uYW1lJywKICAgICAgICAn55So5oi36YKu566xJzogJ3VzZXJfZW1haWwnLAogICAgICAgICfnlKjmiLfnlLXor50nOiAndXNlcl9waG9uZScsCiAgICAgICAgJ+aAp+WIqyc6ICd1c2VyX3NleCcsCiAgICAgICAgJ+eUqOaIt+W5tOm+hCc6ICd1c2VyX2FnZScsCiAgICAgICAgJ+eUqOaIt+exu+WIqyc6ICd1c2VyX2xhYmVsJwogICAgICB9OwoKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBleGNlbERhdGEubGVuZ3RoOyBpKyspIHsKICAgICAgICB2YXIgb2JqID0gZXhjZWxEYXRhW2ldOwoKICAgICAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7CiAgICAgICAgICB2YXIgbmV3S2V5ID0gbmV3S2V5TWFwW2tleV07CgogICAgICAgICAgaWYgKG5ld0tleSkgewogICAgICAgICAgICBvYmpbbmV3S2V5XSA9IG9ialtrZXldOwogICAgICAgICAgICBkZWxldGUgb2JqW2tleV07CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLmV4Y2VsX2ltcG9ydF9kYXRhID0gZXhjZWxEYXRhOyAvLyBjb25zb2xlLmxvZyh0aGlzLmV4Y2VsX2ltcG9ydF9kYXRhKQoKICAgICAgdGhpcy4kZW1pdCgnZXhjZWxfZGF0YScsIHRoaXMuZXhjZWxfaW1wb3J0X2RhdGEpOwogICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoIuWvvOWFpeaIkOWKn++8jOW3suS4uuaCqOaYvuekuuWIsOaVsOaNruihqOagvO+8jOaCqOS5n+WPr+S7peafpeeci2NvbnNvbGUiKTsKICAgIH0KICB9Cn07"},{"version":3,"sources":["ImportExcel.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;AAYA,OAAA,IAAA,MAAA,MAAA;AACA,eAAA;AACA,EAAA,IADA,kBACA;AACA,WAAA;AACA,MAAA,IAAA,EAAA,EADA;AAEA,MAAA,iBAAA,EAAA;AAFA,KAAA;AAIA,GANA;AAOA,EAAA,OAAA,EAAA;AACA,IAAA,WADA,uBACA,IADA,EACA;AACA,WAAA,IAAA,GAAA,IAAA,CAAA,GAAA,CADA,CAEA;;AACA,WAAA,WAAA,CAAA,KAAA,IAAA;AACA,KALA;AAMA,IAAA,WANA,uBAMA,IANA,EAMA;AAAA;;AACA,UAAA,SAAA,GAAA,EAAA,CADA,CAEA;;AACA,UAAA,UAAA,GAAA,IAAA,UAAA,EAAA,CAHA,CAIA;;AACA,MAAA,UAAA,CAAA,MAAA,GAAA,UAAA,EAAA,EAAA;AACA,YAAA;AACA;AAEA,cAAA,IAAA,GAAA,EAAA,CAAA,MAAA,CAAA,MAAA,CAHA,CAIA;;AACA,cAAA,QAAA,GAAA,IAAA,CAAA,IAAA,CAAA,IAAA,EAAA;AAAA,YAAA,IAAA,EAAA;AAAA,WAAA,CAAA,CALA,CAMA;;AACA,UAAA,MAAA,CAAA,IAAA,CAAA,QAAA,CAAA,MAAA,EAAA,OAAA,CAAA,UAAA,KAAA,EAAA;AACA,YAAA,OAAA,CAAA,IAAA,CAAA,QAAA,CAAA,MAAA,CAAA,KAAA,EAAA,MAAA,CAAA;AACA,YAAA,SAAA,CAAA,IAAA,OAAA,SAAA,qBAEA,IAAA,CAAA,KAAA,CAAA,aAAA,CAAA,QAAA,CAAA,MAAA,CAAA,KAAA,CAAA,CAFA,EAAA;AAIA,WANA,EAPA,CAcA;AACA;;AACA,UAAA,KAAA,CAAA,SAAA,CAAA,SAAA,EAhBA,CAgBA;;AACA,SAjBA,CAiBA,OAAA,CAAA,EAAA;AACA,UAAA,KAAA,CAAA,QAAA,CAAA,MAAA,CAAA,SAAA;AACA;AACA,OArBA,CALA,CA2BA;;;AACA,MAAA,UAAA,CAAA,kBAAA,CAAA,IAAA;AACA,KAnCA;AAoCA,IAAA,SApCA,qBAoCA,SApCA,EAoCA;AACA,UAAA,SAAA,GAAA;AAAA;AACA,cAAA,eADA;AAEA,eAAA,WAFA;AAGA,gBAAA,YAHA;AAIA,gBAAA,YAJA;AAKA,cAAA,UALA;AAMA,gBAAA,UANA;AAOA,gBAAA;AAPA,OAAA;;AASA,WAAA,IAAA,CAAA,GAAA,CAAA,EAAA,CAAA,GAAA,SAAA,CAAA,MAAA,EAAA,CAAA,EAAA,EAAA;AACA,YAAA,GAAA,GAAA,SAAA,CAAA,CAAA,CAAA;;AACA,aAAA,IAAA,GAAA,IAAA,GAAA,EAAA;AACA,cAAA,MAAA,GAAA,SAAA,CAAA,GAAA,CAAA;;AACA,cAAA,MAAA,EAAA;AACA,YAAA,GAAA,CAAA,MAAA,CAAA,GAAA,GAAA,CAAA,GAAA,CAAA;AACA,mBAAA,GAAA,CAAA,GAAA,CAAA;AACA;AACA;AAEA;;AACA,WAAA,iBAAA,GAAA,SAAA,CArBA,CAsBA;;AACA,WAAA,KAAA,CAAA,YAAA,EAAA,KAAA,iBAAA;AACA,WAAA,QAAA,CAAA,OAAA,CAAA,+BAAA;AACA;AA7DA;AAPA,CAAA","sourcesContent":["<template>\r\n    <el-upload\r\n      class=\"upload-demo\"\r\n      action\r\n      :auto-upload=\"false\"\r\n      :show-file-list=\"false\"\r\n      :on-change=\"choose_file\"\r\n    >\r\n      <el-button size=\"small\" type=\"primary\">请选择导入excel</el-button>\r\n    </el-upload>\r\n</template>\r\n<script>\r\nimport XLSX from \"xlsx\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      file: \"\",\r\n      excel_import_data:''\r\n    };\r\n  },\r\n  methods: {\r\n    choose_file(file) {\r\n      this.file = file.raw;\r\n    //   console.log(this.file);\r\n      this.importExcel(this.file)\r\n    },\r\n    importExcel(file) {\r\n      var excelData = [];\r\n      //声明一个文件读取器\r\n      const fileReader = new FileReader();\r\n      //文件读取成功时触发事件\r\n      fileReader.onload = (ev) => {\r\n        try {\r\n          //读取的文件;\r\n\r\n          const data = ev.target.result;\r\n          //以二进制流方式读取得到整份excel表格\r\n          const workbook = XLSX.read(data, { type: \"binary\" });\r\n          // 循环遍历excel的sheet对象\r\n          Object.keys(workbook.Sheets).forEach((sheet) => {\r\n            console.info(workbook.Sheets[sheet][\"!ref\"]);\r\n            excelData.push(\r\n              //将excel 转换成json对象放入数组中\r\n              ...XLSX.utils.sheet_to_json(workbook.Sheets[sheet])\r\n            );\r\n          });\r\n          // 自定义事件，比如校验excel数据。转换数据格式…\r\n          // console.log(excelData)//未转换key值的数据\r\n          this.changeKey(excelData)//调用转换key值\r\n        } catch (e) {\r\n          this.$message.danger('文件类型不正确');\r\n        }\r\n      };\r\n      //读取文件\r\n      fileReader.readAsBinaryString(file);\r\n    },\r\n    changeKey(excelData){\r\n        var newKeyMap={//key转换字典，左侧为旧的key值。右侧为新key值\r\n            '昵称':'user_pet_name',\r\n            '用户名':'user_name',\r\n            '用户邮箱':'user_email',\r\n            '用户电话':'user_phone',\r\n            '性别':'user_sex',\r\n            '用户年龄':'user_age',\r\n            '用户类别':'user_label',\r\n        }\r\n        for (let i = 0; i < excelData.length; i++) {\r\n            var obj = excelData[i];\r\n            for (let key in obj) {\r\n                var newKey=newKeyMap[key]\r\n                if(newKey){\r\n                    obj[newKey]=obj[key]\r\n                    delete obj[key]\r\n                }\r\n            }\r\n            \r\n        }\r\n        this.excel_import_data=excelData\r\n        // console.log(this.excel_import_data)\r\n        this.$emit('excel_data',this.excel_import_data)\r\n        this.$message.success(\"导入成功，已为您显示到数据表格，您也可以查看console\");\r\n    }\r\n  },\r\n};\r\n</script>"],"sourceRoot":"src/components/module/excel"}]}